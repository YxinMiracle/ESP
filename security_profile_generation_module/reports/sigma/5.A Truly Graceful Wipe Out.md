# A Truly Graceful Wipe Out

> Source link: https://thedfirreport.com/2023/06/12/a-truly-graceful-wipe-out/
>
> Rewritten section: Discovery



- Rewritten contentï¼š

```
We also observed some other miscellaneous commands that we tend to see in every intrusion. These discovery commands collected information about the administrator groups and users. Although, there was one notable use of the tasklist command where threat actors used the /S parameter to retrieve the list of currently running processes from remote hosts: tasklist.exe /S <IP of remote host>.
```



- Manually written YARA rules

https://thedfirreport.com/2023/06/12/a-truly-graceful-wipe-out/ 

```sigma
title: List remote processes using tasklist
id: 80a56507-6778-4d04-8346-320a70358f2c
description: Detecting the use of tasklist to display processes of remote hosts using the /S parameter.
status: experimental
date: 2023-06-12
modified: 2024-02-23
author: "@kostastsale, @TheDFIRReport"
references:
    - https://thedfirreport.com/2023/06/12/a-truly-graceful-wipe-out
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith: '\tasklist.exe'
        CommandLine|contains: ' /S '
    condition: selection
falsepositives:
    - Administrative activity
level: low
tags:
    - attack.discovery #TA0007
    - attack.t1057
    - dist.public
```



- ESP Rule

```
title: Remote System Process Enumeration
description: Detects use of tasklist.exe to enumerate processes on a remote system, associated with Discovery.
status: Experimental
author: ESP
references: 
	- ESP Intelligence
date: 2025-01-01
logsource:
    category: process_creation
    product: windows
detection:
    selection_image:
        Image|endswith: "tasklist.exe"
    selection_command:
        CommandLine|contains: "/S"
        CommandLine|re: "/S \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"
condition: selection_image and selection_command
level: medium
tags:
    - attack.t1057
```

